{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2024-10-29T18:12:05.286247Z", "invocation_id": "ad9ff53f-8984-4387-a4bf-614439b10f93", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.008691Z", "completed_at": "2024-10-29T18:12:05.031796Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.033797Z", "completed_at": "2024-10-29T18:12:05.033797Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030057668685913086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.netflix_titles", "compiled": true, "compiled_code": "-- models/bronze/netflix_titles.sql\r\n\r\nSELECT\r\n  *\r\nFROM NETFLIX.RAW.NETFLIX_TITLES", "relation_name": "NETFLIX.BRONZE.netflix_titles"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.040348Z", "completed_at": "2024-10-29T18:12:05.048883Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.049885Z", "completed_at": "2024-10-29T18:12:05.049885Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011544942855834961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.atores", "compiled": true, "compiled_code": "-- models/silver/atores.sql\nWITH base AS (\n  SELECT DISTINCT\n    ROW_NUMBER() OVER (ORDER BY TRIM(actor_name)) AS \"ID\",\n    TRIM(actor_name) AS ACTOR,\n    LISTAGG(filme_title, ', ') WITHIN GROUP (ORDER BY filme_title) AS filmes\n  FROM (\n    SELECT\n        TRIM(actor.value) AS actor_name,  -- Nome correto para o ator\n        title AS filme_title\n    FROM\n        NETFLIX.BRONZE.netflix_titles,\n        LATERAL FLATTEN(input => SPLIT(\"CAST\", ', ')) AS actor  -- Corre\u00e7\u00e3o do FLATTEN\n    WHERE\n        actor.value IS NOT NULL AND actor.value != ''\n  ) AS flattened_actors\n  GROUP BY TRIM(actor_name)  -- Agrupar pelo nome correto\n)\nSELECT * FROM base", "relation_name": "NETFLIX.SILVER.atores"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.056083Z", "completed_at": "2024-10-29T18:12:05.065014Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.066184Z", "completed_at": "2024-10-29T18:12:05.066184Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013138532638549805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.diretores", "compiled": true, "compiled_code": "-- models/silver/diretores.sql\nWITH base AS (\n  SELECT DISTINCT\n    ROW_NUMBER() OVER (ORDER BY \"DIRECTOR\") AS \"ID\",\n    \"DIRECTOR\",\n    LISTAGG(\"FILME_TITLE\", ', ') AS filmes\n  FROM (\n    SELECT\n        TRIM(\"DIRECTOR\") AS \"DIRECTOR\",\n        \"TITLE\" AS \"FILME_TITLE\"\n    FROM\n        NETFLIX.BRONZE.netflix_titles,\n        LATERAL FLATTEN(input => SPLIT(\"DIRECTOR\", ', ')) AS \"DIRECTOR\"\n    WHERE\n        \"DIRECTOR\" IS NOT NULL AND \"DIRECTOR\" != ''\n)\nGROUP BY\n    \"DIRECTOR\"\n)\n\nSELECT * FROM base", "relation_name": "NETFLIX.SILVER.diretores"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.071629Z", "completed_at": "2024-10-29T18:12:05.077939Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.078936Z", "completed_at": "2024-10-29T18:12:05.078936Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009510993957519531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.filmes", "compiled": true, "compiled_code": "-- models/silver/filmes.sql\nWITH base AS (\n  SELECT DISTINCT\n    ROW_NUMBER() OVER (ORDER BY \"SHOW_ID\") AS \"ID\",\n    \"SHOW_ID\",\n    \"TITLE\",\n\t\"RELEASE_YEAR\",\n\t\"RATING\",\n\t\"DURATION\",\n\tTRY_TO_DATE(\"DATE_ADDED\", 'MMMM DD, YYYY') AS \"DATE_ADDED\",\n    \"DESCRIPTION\",\n\t\"COUNTRY\",\n\t\"TYPE\",\n\tSPLIT(\"LISTED_IN\", '.') AS \"LISTED_IN\"\n  FROM NETFLIX.BRONZE.netflix_titles\n)\n\nSELECT * FROM base", "relation_name": "NETFLIX.SILVER.filmes"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.081936Z", "completed_at": "2024-10-29T18:12:05.087476Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.088474Z", "completed_at": "2024-10-29T18:12:05.088474Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008539438247680664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.paises", "compiled": true, "compiled_code": "-- models/silver/paises.sql\nWITH base AS (\n  SELECT DISTINCT\n    ROW_NUMBER() OVER (ORDER BY country_cleaned) AS \"ID\",\n    country_cleaned AS \"COUNTRY\"\n  FROM (\n\t  SELECT distinct\n\t\t\tTRIM(SPLIT(country, ', ')[0]) AS country_cleaned\n\t\tFROM\n\t\t\tNETFLIX.BRONZE.netflix_titles\n\t\tWHERE\n\t\t\tcountry IS NOT NULL AND country != ''\n\t)\n  WHERE\n\t\tcountry_cleaned IS NOT NULL AND country_cleaned != ''\n)\nSELECT * FROM base", "relation_name": "NETFLIX.SILVER.paises"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.096500Z", "completed_at": "2024-10-29T18:12:05.108759Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.109757Z", "completed_at": "2024-10-29T18:12:05.110764Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018286705017089844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.tipos", "compiled": true, "compiled_code": "-- models/silver/tipos.sql\nWITH base AS (\n  SELECT DISTINCT\n    ROW_NUMBER() OVER (ORDER BY \"TYPE\") AS \"ID\",\n\t\"TYPE\"\n  FROM NETFLIX.BRONZE.netflix_titles\n  WHERE TYPE IS NOT NULL\n)\n\nSELECT * FROM base", "relation_name": "NETFLIX.SILVER.tipos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.117283Z", "completed_at": "2024-10-29T18:12:05.125801Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.126812Z", "completed_at": "2024-10-29T18:12:05.126812Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013541460037231445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netflix_project.teststest_release_year_is_valid", "compiled": true, "compiled_code": "-- tests/test_release_year_is_valid.sql\nSELECT *\nFROM NETFLIX.BRONZE.netflix_titles\nWHERE release_year < 1950", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.132807Z", "completed_at": "2024-10-29T18:12:05.156366Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.157366Z", "completed_at": "2024-10-29T18:12:05.157366Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026554346084594727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netflix_project.accepted_values_filmes_RELEASE_YEAR__2019__2020__2021__2022__2023.cecc9c28d5", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        RELEASE_YEAR as value_field,\n        count(*) as n_records\n\n    from NETFLIX.SILVER.filmes\n    group by RELEASE_YEAR\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '2019','2020','2021','2022','2023'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.162361Z", "completed_at": "2024-10-29T18:12:05.180060Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.181058Z", "completed_at": "2024-10-29T18:12:05.181058Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021694183349609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netflix_project.not_null_filmes_RELEASE_YEAR.71a78f2109", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect RELEASE_YEAR\nfrom NETFLIX.SILVER.filmes\nwhere RELEASE_YEAR is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.186587Z", "completed_at": "2024-10-29T18:12:05.195112Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.197124Z", "completed_at": "2024-10-29T18:12:05.197124Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01254892349243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netflix_project.not_null_filmes_SHOW_ID.2bf31f2072", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect SHOW_ID\nfrom NETFLIX.SILVER.filmes\nwhere SHOW_ID is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.201123Z", "completed_at": "2024-10-29T18:12:05.214147Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.216162Z", "completed_at": "2024-10-29T18:12:05.216162Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018056392669677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netflix_project.not_null_filmes_TITLE.2d61ba99ee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect TITLE\nfrom NETFLIX.SILVER.filmes\nwhere TITLE is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.226719Z", "completed_at": "2024-10-29T18:12:05.238251Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.239249Z", "completed_at": "2024-10-29T18:12:05.239249Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015562772750854492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netflix_project.unique_filmes_SHOW_ID.b67eaa2c5b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    SHOW_ID as unique_field,\n    count(*) as n_records\n\nfrom NETFLIX.SILVER.filmes\nwhere SHOW_ID is not null\ngroup by SHOW_ID\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.243749Z", "completed_at": "2024-10-29T18:12:05.251755Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.252754Z", "completed_at": "2024-10-29T18:12:05.252754Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011067390441894531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.CAMPANHA_DESENHOS_TERROR", "compiled": true, "compiled_code": "-- models/gold/CAMPANHA_FILMES_TERROR.sql\nWITH base AS (\n  SELECT \n    f.show_id,\n    f.title,\n    d.director,\n    a.actor,\n    p.country,\n    f.date_added,\n    f.release_year,\n    f.rating,\n    f.duration,\n    f.description,\n    f.listed_in\nFROM\n    NETFLIX.BRONZE.netflix_titles f\n    LEFT JOIN NETFLIX.SILVER.diretores d ON f.title = d.filmes\n    LEFT JOIN NETFLIX.SILVER.atores a ON f.title = a.filmes\n    LEFT JOIN NETFLIX.SILVER.paises p ON f.country = p.country\nWHERE\n    f.type = 'TV Show'\n    AND f.listed_in ILIKE '%Horror%'\n\tAND f.listed_in ILIKE '%Anime%'\n)\n\nSELECT * FROM base", "relation_name": "NETFLIX.GOLD.CAMPANHA_DESENHOS_TERROR"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.257851Z", "completed_at": "2024-10-29T18:12:05.266362Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.267358Z", "completed_at": "2024-10-29T18:12:05.267358Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01252293586730957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.CAMPANHA_FILMES_TERROR", "compiled": true, "compiled_code": "-- models/gold/CAMPANHA_FILMES_TERROR.sql\nWITH base AS (\n  SELECT \n    f.show_id,\n    f.title,\n    d.director,\n    a.actor,\n    p.country,\n    f.date_added,\n    f.release_year,\n    f.rating,\n    f.duration,\n    f.description,\n    f.listed_in\nFROM\n    NETFLIX.BRONZE.netflix_titles f\n    LEFT JOIN NETFLIX.SILVER.diretores d ON f.title = d.filmes\n    LEFT JOIN NETFLIX.SILVER.atores a ON f.title = a.filmes\n    LEFT JOIN NETFLIX.SILVER.paises p ON f.country = p.country\nWHERE\n    f.type = 'Movie'\n    AND f.listed_in ILIKE '%Horror%'\n)\n\nSELECT * FROM base", "relation_name": "NETFLIX.GOLD.CAMPANHA_FILMES_TERROR"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-29T18:12:05.272362Z", "completed_at": "2024-10-29T18:12:05.280889Z"}, {"name": "execute", "started_at": "2024-10-29T18:12:05.281884Z", "completed_at": "2024-10-29T18:12:05.281884Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011519432067871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netflix_project.CAMPANHA_SERIES_TERROR", "compiled": true, "compiled_code": "-- models/gold/CAMPANHA_SERIES_TERROR.sql\nWITH base AS (\n  SELECT \n    f.show_id,\n    f.title,\n    d.director,\n    a.actor,\n    p.country,\n    f.date_added,\n    f.release_year,\n    f.rating,\n    f.duration,\n    f.description,\n    f.listed_in\nFROM\n    NETFLIX.BRONZE.netflix_titles f\n    LEFT JOIN NETFLIX.SILVER.diretores d ON f.title = d.filmes\n    LEFT JOIN NETFLIX.SILVER.atores a ON f.title = a.filmes\n    LEFT JOIN NETFLIX.SILVER.paises p ON f.country = p.country\nWHERE\n    f.type = 'TV Show'\n--    AND ARRAY_TO_STRING(f.listed_in, ',') ILIKE '%Horror%'\n    AND f.listed_in ILIKE '%Horror%'\n)\n\nSELECT * FROM base", "relation_name": "NETFLIX.GOLD.CAMPANHA_SERIES_TERROR"}], "elapsed_time": 5.488365888595581, "args": {"defer": false, "cache_selected_only": false, "indirect_selection": "eager", "empty_catalog": false, "show_resource_report": false, "which": "generate", "use_colors": true, "profiles_dir": "C:\\Users\\brend\\.dbt", "favor_state": false, "log_format": "default", "project_dir": "C:\\Users\\brend\\Downloads\\impacta\\DBT\\netflix_project", "log_path": "C:\\Users\\brend\\Downloads\\impacta\\DBT\\netflix_project\\logs", "source_freshness_run_project_hooks": false, "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}, "partial_parse_file_diff": true, "write_json": true, "strict_mode": false, "log_level": "info", "send_anonymous_usage_stats": true, "log_level_file": "debug", "static": false, "warn_error_options": {"include": [], "exclude": []}, "require_resource_names_without_spaces": false, "quiet": false, "log_format_file": "debug", "static_parser": true, "use_colors_file": true, "exclude": [], "version_check": true, "populate_cache": true, "print": true, "select": [], "compile": true, "partial_parse": true, "printer_width": 80, "introspect": true, "macro_debugging": false, "enable_legacy_logger": false, "log_file_max_bytes": 10485760, "invocation_command": "dbt docs generate"}}